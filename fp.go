package ja3

import (
	"crypto/sha256"
	"errors"
	"fmt"
	"net/http"

	"github.com/gospider007/tools"
	"github.com/mileusna/useragent"
	utls "github.com/refraction-networking/utls"
	"golang.org/x/crypto/cryptobyte"
)

type TlsSpec struct {
	clientHelloID      utls.ClientHelloID
	raw                []byte
	ContentType        uint8             //contentType
	MessageVersion     uint16            //MessageVersion
	HandshakeVersion   uint16            //HandshakeVersion
	HandShakeType      uint8             //HandShakeType
	RandomTime         uint32            //RandomTime
	RandomBytes        []byte            //RandomBytes
	SessionId          cryptobyte.String //sessionId
	CipherSuites       []uint16          //cipherSuites
	CompressionMethods cryptobyte.String //CompressionMethods
	Extensions         []Extension
}
type Extension struct {
	Type uint16
	Data cryptobyte.String
}

func createExtension(extensionId uint16, data []byte) utls.TLSExtension {
	switch extensionId {
	case 0:
		return new(utls.SNIExtension)
	case 5:
		return new(utls.StatusRequestExtension)
	case 17:
		return new(utls.StatusRequestV2Extension)
	case 18:
		return new(utls.SCTExtension)
	case 23:
		return new(utls.ExtendedMasterSecretExtension)
	case 35:
		return new(utls.SessionTicketExtension)
	case 41:
		return new(utls.UtlsPreSharedKeyExtension)
	case 44:
		return new(utls.CookieExtension)
	case 57:
		return new(utls.QUICTransportParametersExtension)
	case 30031:
		extV := new(utls.FakeChannelIDExtension)
		extV.OldExtensionID = true
		return extV
	case 30032:
		extV := new(utls.FakeChannelIDExtension)
		return extV
	case 65037:
		return utls.BoringGREASEECH()
	default:
		ext := utls.ExtensionFromID(extensionId)
		if ext == nil {
			return &utls.GenericExtension{
				Id:   extensionId,
				Data: data,
			}
		}
		extWriter, ok := ext.(utls.TLSExtensionWriter)
		if ok {
			extWriter.Write(data)
			return ext
		}
		return &utls.GenericExtension{
			Id:   extensionId,
			Data: data,
		}
	}
}

func (obj *TlsSpec) setClientHelloID(clientHelloID utls.ClientHelloID) {
	obj.clientHelloID = clientHelloID
}
func (obj Extension) utlsExt() utls.TLSExtension {
	return createExtension(obj.Type, obj.Data)
}

// type:  11 : utls.SupportedPointsExtension
func (obj *TlsSpec) Points() []uint8 {
	for _, ext := range obj.Extensions {
		if ext.Type == 11 {
			ex := new(utls.SupportedPointsExtension)
			ex.Write(ext.Data)
			return ex.SupportedPoints
		}
	}
	return nil
}

// type:  16 : utls.ALPNExtension
func (obj *TlsSpec) Protocols() []string {
	for _, ext := range obj.Extensions {
		if ext.Type == 16 {
			ex := new(utls.ALPNExtension)
			ex.Write(ext.Data)
			return ex.AlpnProtocols
		}
	}
	return nil
}

// type:  43 : utls.SupportedVersionsExtension
func (obj *TlsSpec) Versions() []uint16 {
	for _, ext := range obj.Extensions {
		if ext.Type == 43 {
			ex := new(utls.SupportedVersionsExtension)
			ex.Write(ext.Data)
			return ex.Versions
		}
	}
	return nil
}

// type:  13 : utls.SignatureAlgorithmsExtension
func (obj *TlsSpec) Algorithms() []uint16 {
	for _, ext := range obj.Extensions {
		if ext.Type == 13 {
			ex := new(utls.SignatureAlgorithmsExtension)
			ex.Write(ext.Data)
			algorithms := make([]uint16, len(ex.SupportedSignatureAlgorithms))
			for i, algorithm := range ex.SupportedSignatureAlgorithms {
				algorithms[i] = uint16(algorithm)
			}
			return algorithms
		}
	}
	return nil
}

// type:  10 : utls.SupportedCurvesExtension
func (obj *TlsSpec) Curves() []uint16 {
	for _, ext := range obj.Extensions {
		if ext.Type == 10 {
			ex := new(utls.SupportedCurvesExtension)
			ex.Write(ext.Data)
			algorithms := make([]uint16, len(ex.Curves))
			for i, algorithm := range ex.Curves {
				algorithms[i] = uint16(algorithm)
			}
			return algorithms
		}
	}
	return nil
}
func (obj *TlsSpec) ServerName() string {
	for _, ext := range obj.Extensions {
		if ext.Type == 0 {
			ex := new(utls.SNIExtension)
			ex.Write(ext.Data)
			return ex.ServerName
		}
	}
	return ""
}
func (obj *TlsSpec) utlsClientHelloSpec() utls.ClientHelloSpec {
	// fingerprinter := &utls.Fingerprinter{
	// 	AllowBluntMimicry: true,
	// 	RealPSKResumption: true,
	// 	AlwaysAddPadding:  true,
	// }
	// generatedSpec, _ := fingerprinter.FingerprintClientHello(obj.raw)
	// return *generatedSpec
	// spec, _ := utls.UTLSIdToSpec(utls.HelloChrome_131)
	// return spec
	if obj.clientHelloID != utls.HelloCustom && obj.clientHelloID.Client != "" {
		if spec, err := utls.UTLSIdToSpec(obj.clientHelloID); err == nil {
			return spec
		}
	}
	var clientHelloSpec utls.ClientHelloSpec
	clientHelloSpec.CipherSuites = obj.CipherSuites
	clientHelloSpec.CompressionMethods = obj.CompressionMethods
	clientHelloSpec.Extensions = make([]utls.TLSExtension, len(obj.Extensions))
	for i, ext := range obj.Extensions {
		clientHelloSpec.Extensions[i] = ext.utlsExt()
	}
	clientHelloSpec.GetSessionID = sha256.Sum256
	return clientHelloSpec
}
func (obj *TlsSpec) Bytes() []byte {
	return obj.raw
}
func (obj *TlsSpec) Hex() string {
	return tools.Hex(obj.Bytes())
}
func (obj *TlsSpec) Map() map[string]any {
	extensions := make([]map[string]any, len(obj.Extensions))
	for i, ext := range obj.Extensions {
		extensions[i] = map[string]any{
			"type": ext.Type,
			"data": tools.Hex(ext.Data),
		}
	}
	results := map[string]any{
		"points":         obj.Points(),
		"protocols":      obj.Protocols(),
		"versions":       obj.Versions(),
		"algorithms":     obj.Algorithms(),
		"curves":         obj.Curves(),
		"serverName":     obj.ServerName(),
		"contentType":    obj.ContentType,
		"messageVersion": obj.MessageVersion,

		"handshakeVersion":   obj.HandshakeVersion,
		"handShakeType":      obj.HandShakeType,
		"randomTime":         obj.RandomTime,
		"randomBytes":        obj.RandomBytes,
		"sessionId":          obj.SessionId,
		"cipherSuites":       obj.CipherSuites,
		"compressionMethods": obj.CompressionMethods,
		"extensions":         extensions,
	}
	return results
}

func ParseTlsSpec(clienthello []byte) (clientHelloInfo *TlsSpec, err error) {
	clientHelloInfo = new(TlsSpec)
	clientHelloInfo.raw = clienthello
	plaintext := cryptobyte.String(clienthello)
	if !plaintext.ReadUint8(&clientHelloInfo.ContentType) {
		err = errors.New("contentType error")
		return
	}
	if !plaintext.ReadUint16(&clientHelloInfo.MessageVersion) {
		err = errors.New("tlsMinVersion error")
		return
	}
	//handShakeProtocol
	var handShakeProtocol cryptobyte.String
	if !plaintext.ReadUint16LengthPrefixed(&handShakeProtocol) {
		err = errors.New("handShakeProtocol error")
		return
	}
	if !handShakeProtocol.ReadUint8(&clientHelloInfo.HandShakeType) {
		err = errors.New("handShakeType error")
		return
	}
	//read  helloData
	var handShakeData cryptobyte.String
	if !handShakeProtocol.ReadUint24LengthPrefixed(&handShakeData) {
		err = errors.New("handShakeData error")
		return
	}
	if !handShakeData.ReadUint16(&clientHelloInfo.HandshakeVersion) {
		err = errors.New("tlsMaxVersion error")
		return
	}
	if !handShakeData.ReadUint32(&clientHelloInfo.RandomTime) {
		err = errors.New("randomTime error")
		return
	}
	if !handShakeData.ReadBytes(&clientHelloInfo.RandomBytes, 28) {
		err = errors.New("randomTime error")
		return
	}
	if !handShakeData.ReadUint8LengthPrefixed(&clientHelloInfo.SessionId) {
		err = errors.New("sessionId error")
		return
	}
	var cipherSuitesData cryptobyte.String
	if !handShakeData.ReadUint16LengthPrefixed(&cipherSuitesData) {
		err = errors.New("cipherSuites error")
		return
	}
	clientHelloInfo.CipherSuites = []uint16{}
	for !cipherSuitesData.Empty() {
		var cipherSuite uint16
		if cipherSuitesData.ReadUint16(&cipherSuite) {
			clientHelloInfo.CipherSuites = append(clientHelloInfo.CipherSuites, cipherSuite)
		}
	}
	if !handShakeData.ReadUint8LengthPrefixed(&clientHelloInfo.CompressionMethods) {
		err = errors.New("compressionMethods error")
		return
	}
	var extensionsData cryptobyte.String
	if !handShakeData.ReadUint16LengthPrefixed(&extensionsData) {
		err = errors.New("handShakeData error")
		return
	}
	clientHelloInfo.Extensions = []Extension{}
	for !extensionsData.Empty() {
		var extension uint16
		var extData cryptobyte.String
		if extensionsData.ReadUint16(&extension) && extensionsData.ReadUint16LengthPrefixed(&extData) {
			clientHelloInfo.Extensions = append(clientHelloInfo.Extensions, Extension{
				Type: extension,
				Data: extData,
			})
		}
	}

	return
}

// chrome
var Chrome_Mac_arm64_137 = ParseGospiderSpecNoError("160301076a0100076603037894337c7c858ccc35b93590111f3422fce8907d087e915fae826858e2aac44620ca937ca4249c8139781bbeee94e0c892b9c55619a5f32f6cb4dfd3132f03e57b00200a0a130113021303c02bc02fc02cc030cca9cca8c013c014009c009d002f0035010006fd6a6a00000005000501000000000023000000170000ff0100010000120000003304ef04eddada00010011ec04c04a244ec5f5282871a6b1d20861e23845a3169da69c559bb6ca19029ba95233b2cdfcf4075a4793c1f3023a1b77a83118ef125ea18019d2a6c51570c09e27b0161c4b7b195e9d85958f0c67c0c4b144183784db59a0ca2129669dc52b11d5502a007a5184f83b83660cb5c57399d69a7c9b9474a7153da297d5d04856734791c63b18eaa861080847c1452c24555b3837f1287a8a4a94ed130188317fc279be2b80ce0277317588b76ed913c9cb28a44b3783ab6cf627cc569c26f6e080c3362f5fd7667651caaf669ad92744eef598c485c8a6b47cc33707a77c8176849fc96c113ba8b2ebd77f2f330208c80a5d508f1ab2bc165ba954c08d31949a5cc2cbcaa6427d4b38c263c5966a981871c541ec6d8af94617fc05d23b1a8e4b7f6321b885d89d4e507d5c0b123b8c9c826b0e43920d5637083d54c1c4abc07b3786ae059a9944c038583eede14b5c54c147012fe5695adc001da93c2622237fe755ce92d81516d77f5ac2195cac2b7d001477f6c452064c95507c8e831852c1be5f524b03341be3b759dc56b6bd99bdb1244d61a81988d25c9bdab3aed83d8994816646c76dc54943ab6f400522a651cecbcc780e409f99086f547b51ce86b0278782c5c184b9e7532770b4b37b2073e271540a38a8c3991ee4b180c14e2b80acb303576afa08e7a9ba88501f88e59c51d170fcb91cb33b3ba550422d38336071398e6479f38babd4c860f1f42fef120c7bb6a917c812fc6b144f3557c6976b1c8a794340b7a781903a077caf0549e95c634bf3220acb042fe61b94490cd542b38e4188957081be459683563b3527748156c2782540efa24993024d56ec10092a3fb53805265306887a32bcd38f4deb06b1063eee5b6c9914b83c78028a232b76847fa7cc2211c193fac055287c38a96a4cde5b1ce51c2119c31d404837a4a23f0f0c12559c9db65cb0baaacb70d2596547cd6ec572d598640ca203e15880a3d7a82b13cfc6461f68c596c2864abc9384bc28b09fd33185c5c968d483864667f130c3a8eb4264d64b6ec84325b23dca50042d15c8a7923a00d96aba905042a106d3b55d7dc8af9ba805bdd617f82b3b6bc3c418a9aa3dd6132ef60d68061a7a6258147b79e9c24fcb760c1eb28fbee9c6130ccdbd0817994053a588339df585f2bc2ae15c0a36bc0b43154f08fa86eef65258ec7956ec427bc3c794532fb46c449132c79e777f578a5f0b20a7b9827514a907a199c05ab1b024ccb661505060888678769b951924110c26d1e0aa55bb3444574510f8bc837561a21c67f06ca8f54a2b2cbbaefe25877a786715d70a2b94a4f6d20f0dfb6cc78a09b7247858f97d1a91bbb912b627157b548a084093128d801b86d027e039244fd63e3156354d505a211311253548e763c34cd938719341286815a7d630db678f40f3b76be35a3ac77214bbcd3d37c0557733e747374305c1b5e81600cb003716b947966a45f02a38780aec205b44c904c50779e6d97e07764259b7459996aa79617ef62ab471d4aec7a63e409c31a564025cb99ab26743dc373e0f97bf39acbbeda6131d535f4223bb35155aa46a228cf63f00909e0a805277a689e9f11697a19b6efa879bc41a6dab6475c2cf0c4b46a8a7ca6925f8190e9c467dd5883923d1ad9fc73eb27ad095110ca8c1ff633f10fe5d1689b76057714c84af32a221b27c4c922b7e280a13ccd94b001d00206246c9e77988e628cb5e14cd306fff38ca19fff73906cd81dae91adf32048b21001b0003020002000a000c000adada11ec001d00170018002d00020101000b0002010044cd00050003026832fe0d00da00000100011300200b680bd48685d196c906d728e3739dddbfae76f34c413b8873860a708bc27a2100b037e522271bcb52e651989aae0858ebe9950a1f460b7b6a89fccc40be3f7e1d5df375805cd6e3001ee7cbd029cecf848bf227fe6f2e383b739ade87f2d573a97e268a46cb1046a415b5095f12c83b7aa8690005e3407157aef9955798e24a1a0ea453bd0cbf913415cf0463dbbcbc65efcb72df1eae91ae6522adbfdd94cf4f558674e97d67a1dea7c81a346203b22d0a9018dc8eea044e8aa95bc8bd029779fd226aa56bc4ca51f770d4b9ae7b295bce0010000e000c02683208687474702f312e310000000e000c0000096c6f63616c686f7374002b000706dada03040303000d00120010040308040401050308050501080606015a5a00010000290094006f0069132346d60f25dcfb09d3a96f19d69d8f15bbd935e226d52e7b650c7d3bd1703208fe4cad7e911275c5b0faff16a5897da3ee267e0aa77590e8b2979a69abff8dca8cb66838496e9548a8bb6c579ae75ec85d9251561ee5fa368f334968e448cc564c56718d0dd8e74d89020cc10021206fadd0b4d7f9bc060fcc52e63b619bcc77917a50c98605964f1babfe3418c331@@505249202a20485454502f322e300d0a0d0a534d0d0a0d0a00001804000000000000010001000000020000000000040060000000060004000000000408000000000000ef000100000004010000000000034901250000000180000000db82418aa0e41d139d09b8f3efbf87844085aec1cd48ff86a8eb10649cbf5886a8eb10649cbf408d4148b1275ad1ad5d034ca7b29f07226d61634f532240016a8e98e8acd216c89254262ee3a2d2ff40016f8e98e8acd216c89254262ee3a2d2ff4001658e98e8acd216c89254262ee3a2d2ff4001648e98e8acd216c89254262ee3a2d2ff40016b8e98e8acd216c89254262ee3a2d2ff4001628e98e8acd216c89254262ee3a2d2ff40874148b1275ad1ffb8fe711cf350552f4f61e92ff3f7de0fe42cbbfcfd29fcde9ec3d26b69fe7efbc1fc85977f9fa53f9d274b10ff776c1d527f3f7de0fe44d7f34001708e98e8acd216c89254262ee3a2d2ff408b4148b1275ad1ad49e33505023f304001668e98e8acd216c89254262ee3a2d2ff4001768e98e8acd216c89254262ee3a2d2ff4001758e98e8acd216c89254262ee3a2d2ff40017a8e98e8acd216c89254262ee3a2d2ff4001778e98e8acd216c89254262ee3a2d2ff4001618e98e8acd216c89254262ee3a2d2ff4001718e98e8acd216c89254262ee3a2d2ff40016c8e98e8acd216c89254262ee3a2d2ff4001728e98e8acd216c89254262ee3a2d2ff4001738e98e8acd216c89254262ee3a2d2ff4001638e98e8acd216c89254262ee3a2d2ff4001788e98e8acd216c89254262ee3a2d2ff4001798e98e8acd216c89254262ee3a2d2ff4001698e98e8acd216c89254262ee3a2d2ff40016d8e98e8acd216c89254262ee3a2d2ff40016e8e98e8acd216c89254262ee3a2d2ff4001678e98e8acd216c89254262ee3a2d2ff7ad9d07f66a281b0dae053fad0321aa49d13fda992a49685340c8a6adca7e28104416e277fb521aeba0bc8b1e632586d975765c53facd8f7e8cff4a506ea5531149d4ffda97a7b0f49580b2eae05c0b814dc394761986d975765cf4001748e98e8acd216c89254262ee3a2d2ff4001688e98e8acd216c89254262ee3a2d2ff53032a2f2a408a4148b4a549275906497f8840e92ac7b0d31aaf408a4148b4a549275a93c85f8321ec47408a4148b4a549275a42a13f842d35a7d773919d29ad1718628390744e7426e3cfbefb1f50929bd9abfa5242cb40d25fa523b3e94f684c9f518cf73ad7b4fd7b9fefb4005dff6087ea5f50771d16974086aec31ec327d785b600fd286f")
var Chrome_Mac_arm64_141 = ParseGospiderSpecNoError("16030106b2010006ae03038514f3396bdb9683c44af7d50c1da55ccc795e4d220f477fd458362ea53237f6203b84c81b8a198690340f82df6db852eb954554616daef8bc8abbddbeef70b62d0020eaea130113021303c02bc02fc02cc030cca9cca8c013c014009c009d002f0035010006453a3a0000ff0100010000120000000a000c000a6a6a11ec001d001700180000000e000c0000096c6f63616c686f7374000b00020100003304ef04ed6a6a00010011ec04c027873ffc188e76e73c7131386ae93286f15a3c5689547a07031667e4d16ed9bc960cb3678b9443a5a552df0ccf5304a31868853fa310597c048c903b669ccea4619d457579a9c41cc2726b485024babcccdaab0be74ab32e85860d683dd639435b12aa1e673c2392359fac25a78148eb76325e00319f7bc2a27cc69bf58dfc42811d695c23194b63ac5b2ffc85774c00c2139174b474b9a6aea80417f3553690a102b43b8f6b715fd444241843c4132b65c0761f61230a13d11c22a32eb00440b7f9a369d8c19fb81fc8c50ad36127530bb163e0287659ac38c778b5b714ff1589c179051d33ac83a63f7dfaa2fb7292709372c6685d3f508c116186a532b6ee083fcdc1b489e5793de77597a46a74c7750adb7c68334bf426397a1c1561b2375215a4cb81b82e980d5d71c76b01a9bc2bcef347aad4a8b67a576cd7aabcfcb717ede894037a42c851327c0c0dbd656a310a8363d29ef9a20488e7262903b0b1a70cc4d666bc9c12c28964ac015584da3da2206b919bcf1291c6d7c60517826b9a314e3da2845f3a5794ca17bbb211eb86b54afc6db768363342743b5b7b4fb0c2a4f01eca97a0b00b2033362ee856baba5758053002e13b52f7d77c77e18508c737b4d89a5c8247a8b20e362ac8c824726fc12618149374792aceb85397e55de7774761e65fc922317c64546c7c64dde0782783620de04b2b8a6e1fa91e15bc31bfd22b268b4299332580932081acc932fbca2860c61920becf11b63700a62a72c93e475a91d68ae32c1e0ac751d4c35b5d1a39b074474d6cc8132330548779a6c25709373998fc793db3446d612136916b2f47a82680552f70c9bce8c4785a80520170f4eac167a96d7b552ee5020e9f402e7ec4576ef3060d903ef13678522a0b5fa712c1fa9f4bfa2a6cb6696c7609e83132458a16da226ead4b208d828cda4c9b2fb955dddc519286c5716861fb233bc14b3b806a6d40a633cd9bba33182633d98c3dd74bf828be2f43cd494aa2d406b54578520a379c8b2bcb7945cd81d67ad9b382a018c89260a0c5e4567cd01c10369fd7e4253f05291e59904f5b68a1b280656257b9841be0b2380b24b37fd58d16701b0f3b25c601a0942531a11479a1108053600dee11bbabca9b62e294a723027fac9e220040888253fb921b26f18551326ebaf921eaf3890b119ab2310631a256844b69ec8305f3f778a7714a4f2686e7963bb4f4457e3869fa666237aba066a9bcac570468d2bbd85b5df116227ef64d8ec6972f7b8b4a5942c7e46d813287ab154a0ef07d06a0b66b0920aac5ccbba3a83f544e969095119813b91a46689679b2031d12418679aacc459b4579a5308bc9c09cb63f9f982eb8709db300c268c7387b6757f06a5f1292475a8c4fff8997174c80884a67b6e2231eab33c009d070c3c5a0e7ab1aebc5809850bbdc9cdfd7af61d27134d971d5223c4d84af589a39db7a534e374e7d946fd2c43c43d8589b409accd17ea7b138dac807fe88962cacbe04e9185d9881ca808f6feaa971a06cf4a7b71978307eec28d4b8555aeb9f8624964b5c403ff772b7f1187ad043767ccad15a52f9866e6da096bd29669e69bc57a672d8121d730180d939c76a03424b9046367e29c979c3f61d47873e58342a113abcb1816a26e654f25cf23cc070cd09d4b666f3dd6ea8307861c035f83a5181226bf9edd50c71617a6904001d0020132b1649a958b4daa25a9754e5342dbf6ce949a81515fa4722a8769a69c60b64002b0007065a5a030403030010000e000c02683208687474702f312e31001b0003020002fe0d00ba0000010001bc002040ec13c582c419ea459eda7fad75ef68da3e4e5cf792db6425ce0f95ada7145b00904d0f898de51b2479c9f165c25f98e918803c18e6096a9292c318e39596c7a90eb31e737fa15b947dcbdeb39d995c64939255d76b031355e01bb266b39d39e9de55e5407cdcc7638d2c2a0fb5defc024c79357002eac880a0e94714648b6b1b594154da6acf2a77aa144275956f6efdf61256f26965473eecabf6861371a5029450c1a23b14b638caff9fe95f80d1565f000500050100000000000d00120010040308040401050308050501080606010017000000230000002d0002010144cd000500030268320a0a000100@@505249202a20485454502f322e300d0a0d0a534d0d0a0d0a00001804000000000000010001000000020000000000040060000000060004000000000408000000000000ef000100034801250000000180000000db82418aa0e41d139d09b8f3efbf87844085aec1cd48ff86a8eb10649cbf5886a8eb10649cbf408d4148b1275ad1ad5d034ca7b29f07226d61634f532240016a8e98e8acd216c89254262ee3a2d2ff40016f8e98e8acd216c89254262ee3a2d2ff4001658e98e8acd216c89254262ee3a2d2ff4001648e98e8acd216c89254262ee3a2d2ff40016b8e98e8acd216c89254262ee3a2d2ff4001628e98e8acd216c89254262ee3a2d2ff40874148b1275ad1ffb7fe711cf350552f4f61e92ff3f7de0fe42d07f9fa53f9d274ff90c576c1d527f3f7de0fe5efe7e94fe6f4f61e935b4ff3f7de0fe42d07f94001708e98e8acd216c89254262ee3a2d2ff408b4148b1275ad1ad49e33505023f304001668e98e8acd216c89254262ee3a2d2ff4001768e98e8acd216c89254262ee3a2d2ff4001758e98e8acd216c89254262ee3a2d2ff40017a8e98e8acd216c89254262ee3a2d2ff4001778e98e8acd216c89254262ee3a2d2ff4001618e98e8acd216c89254262ee3a2d2ff4001718e98e8acd216c89254262ee3a2d2ff40016c8e98e8acd216c89254262ee3a2d2ff4001728e98e8acd216c89254262ee3a2d2ff4001738e98e8acd216c89254262ee3a2d2ff4001638e98e8acd216c89254262ee3a2d2ff4001788e98e8acd216c89254262ee3a2d2ff4001798e98e8acd216c89254262ee3a2d2ff4001698e98e8acd216c89254262ee3a2d2ff40016d8e98e8acd216c89254262ee3a2d2ff40016e8e98e8acd216c89254262ee3a2d2ff4001678e98e8acd216c89254262ee3a2d2ff7ad9d07f66a281b0dae053fad0321aa49d13fda992a49685340c8a6adca7e28104416e277fb521aeba0bc8b1e632586d975765c53facd8f7e8cff4a506ea5531149d4ffda97a7b0f49580b415c0b817029b8728ec330db2eaecb9f4001748e98e8acd216c89254262ee3a2d2ff4001688e98e8acd216c89254262ee3a2d2ff53032a2f2a408a4148b4a549275906497f8840e92ac7b0d31aaf408a4148b4a549275a93c85f8321ec47408a4148b4a549275a42a13f842d35a7d773919d29ad1718628390744e7426e3cfbefb1f50929bd9abfa5242cb40d25fa523b3e94f684c9f518cf73ad7b4fd7b9fefb4005dff6087ea5f50771d16974086aec31ec327d785b600fd286f")
var Chrome_Mac_arm64_142 = ParseGospiderSpecNoError("16030107120100070e0303d729ae41e6887cd1556556d13c02b463e9b905a177bd66127de064463dd4b9ad209699c3a5837fc378ab52097e7c4f913ca79bacebb7d227b33320e1f4eb7d92f20020caca130113021303c02bc02fc02cc030cca9cca8c013c014009c009d002f0035010006a52a2a000000170000002b0007061a1a030403030000000e000c0000096c6f63616c686f7374ff01000100002d00020101003304ef04ed1a1a00010011ec04c0a09833da94027cbbb81592218345cf946c0230919819c609b5824586e2077647600e79858c74b7693a1c0fb85eac23ac1a4377420aaf8b88c0e9d109cc409481c24b44657646c593e1c9be5885a04c71aa98c885a18c2e636c9d782c8cd134cdd0d8848e86487cc34687802e61c9bf11eb81d820420fe43d6be4660f6776c618b639b753bda005a2d37ac783a4dd095ae6776f04055055e2b247c786178b9a4ce6beeab53fe1f53171a87ad3b9b649f99f40c4cdb90a1c9f46c8f7a54c8382140cd350ba086dd054120016b2359369dd8a46b7a4770f52187bbc388c568c8b15317f4c32b69366c9e9c44639527ad70493b476b9b2a02e82b15c58586a9bc3675227877866d05a826907414f1923ec2a528ce6a27939c804ac6f12457bc1535f4931ae6a751423db8cd1ab51c2e10660b67f74e84b5f394994aa17c8a2118a5417b2a22faf20822ed547f915c6faabb6bd3c55605353ab660aa4318bfa12809e35a93cd13615560630e7bd44845ab802601f39b7e2bb2a78556df4093cbc79cd04d2c367a4002d2cc9af7186cbe46eb13c159f9356c82981d6e34782e34823a831361bbebb79844fe2227930a620ac37874672fdfc409857bf6770bbfa365339405a88a3a06bf9c428f65422a56f8e0cb541c656cba931461bc3f81702bcf5987b677a243a7e67c523bd8ab8f3f6b35748697c555e45d1c50f4924b933189b617bddba66be99c4d5f37919e0b2996c3cec90703af8c56f4797bc287c94319236f74eecba352b701b39a7bed91067bb75082da79e224b91c54687d9e9039967a3ee0904965874798c2db19b44233a5b8a129784d99b7f512f323a9c98d049fe08945efa0e539832b7785aa89a1ce7f0c779dc7fec5c12e0b3c5ebe828afa4cbe176aa92d21e6060bf032616e6fb38b05b8cb37b41f232b05370a385376ae8e9c2f8f943e3331d6f9c5b34e12e971ca655e3c4ffa38fb7000ff6e4cbd7a376ce19b4abd8927482acdcc22f7428454e2267a51b07d4e9bf2be29638f84796064103050ad3749a7ea282efbaa76a0368f496056dec86b074324ca11cbd500a1d12145ec168ec319453846efaf3b3f99564b76529ffe84f34e815b2b4a9c3e8b84bc0ab33f846809c2389e6352c488b9724752c4a43aa759748c73a6d6a979899855ea277e9a8120b2b37262a1c34c9c69c365ea3f4439e575e38cabf05c970fb9253ecca1234897a51f130fcf30c07a281c6a872149709f8d931917499318699b9963bd207308e212be9b576c1e13d32977be60218650324895894bb7c974a2a98247b063fa59be442ba406a81c9233196181fa264c1eed98ce29938aeb811f4572700e3b445895e3b748f390c27044ccf9204cafb03922f301750a92b2414a0ddf94720e85a8dc0bc6213ceb9211331ab27786410666296aef11183f77e15e49c007382a5d3c8b306b23667c34303b662776f641552616a240c55844136495720190d137b9800218973999c4b790708499d5a76202b1cd42798c3d1cc6fa0656dbca3a15483d9b8a127c74a3d06315927a631305c19f20f49fc2f20259c91d762722c20a1d036a4a090695ac3c6f75390f28010729f241b5781433ee6f85850cc9373015df08413f53b4a72a73095b3ec77e7a8e7ebc8cebd98dbb98cda2ff8aa7f750876a1ae2ded3c1315efc47423d01e8415f9613b9eaf85b5cdfb6e5058e946001d002015c8a293a9dbfa5ad9d5b68bcc54ba2aba13aeccb5b4d87f57a90204ca31a7330010000e000c02683208687474702f312e31fe0d011a0000010001930020466c9073f20a21819957cdada5d52e7f95141c0e7cb20fd0c30be89c2a3b456e00f0e04de0899f7e257aa8278823720c3ad33eaf9381457c4881063d40a3bb40dee65eb7ffef698b85269ef9660c41f6129347147aa341e4233ef5c352806981afc2624c8521e57af8030c615c900ba33e2916382168d74537e49ee57be5b5f1a8bb6887495c6e95cdc64acfe5656f52f6268d0e2252cb28dbab848ac6e769d65c7e0b5df723f95bcafe2636fc7fcb6421447530824faa561e1b7fdb11b00521ef8881c78ba00f0c41d907dd0dbfdd7e6d0803d1000fbb67bd2384a49fad9dc8310da45c2d1fa1ff84afd85a8f8cbf9e8fcc3c4062530e8a46ba912db57c164ce10e594517522c6a3ea5df0e69928a9dbea2000b0002010000230000000500050100000000000d001200100403080404010503080505010806060100120000000a000c000a1a1a11ec001d00170018001b000302000244cd00050003026832aaaa000100@@505249202a20485454502f322e300d0a0d0a534d0d0a0d0a00001804000000000000010001000000020000000000040060000000060004000000000408000000000000ef00010001ca01250000000180000000ff82418aa0e41d139d09b8f3efbf878440874148b1275ad1ffb8fe6f4f61e935b4ff3f7de0fe42d0bf9fa53f9c473cd4154bd3d87a4bfcfdf783f90b42fe7e94fe749d3142a5db07549fcfdf783f97dffe7f408b4148b1275ad1ad49e33505023f30408d4148b1275ad1ad5d034ca7b29f07226d61634f53224092b6b9ac1c8558d520a4b6c2ad617b5a54251f01317ad9d07f66a281b0dae053fad0321aa49d13fda992a49685340c8a6adca7e28104416e277fb521aeba0bc8b1e632586d975765c53facd8f7e8cff4a506ea5531149d4ffda97a7b0f49580b425c0b817029b8728ec330db2eaecb9f53e5497ca589d34d1f43aeba0c41a4c7a98f33a69a3fdf9a68fa1d75d0620d263d4c79a68fbed00177fe8d48e62b03ee697e8d48e62b1e0b1d7f46a4731581d754df5f2c7cfdf6800bbdf43aeba0c41a4c7a9841a6a8b22c5f249c754c5fbef046cfdf6800bbbf408a4148b4a549275906497f83a8f517408a4148b4a549275a93c85f86a87dcd30d25f408a4148b4a549275ad416cf023f31408a4148b4a549275a42a13f8690e4b692d49f50929bd9abfa5242cb40d25fa523b3e94f684c9f518cf73ad7b4fd7b9fefb4005dff4086aec31ec327d785b6007d286f")

// firefox
var Firefox_Mac_arm64_140 = ParseGospiderSpecNoError("1603010895010008910303fabb285aa168a4e344a9b9ff32e7103b0b42753f43c2ebc9a030e52834e7da8420540f3791329a3e21650ec7c6f8dfef2a3577ec2b6e301be484b499c1f5dcb63a0022130113031302c02bc02fcca9cca8c02cc030c00ac009c013c014009c009d002f0035010008260000000e000c0000096c6f63616c686f737400170000ff01000100000a0010000e11ec001d00170018001901000101000b000201000010000e000c02683208687474702f312e310005000501000000000022000a00080403050306030203001200000033052f052d11ec04c09e676125a7932744befd3c1e6720485cbc11f72ac3cd498c19e035763bca6344bb50c12cd54466ce023c6844af0092bd72d36d226c263b0675a7415860f5084ce9b1b0249b2830abc778c32fc6aeee42963b693bd59bab11d095c451805c3cc6388779cf4a97ece27641d19def16a57ef57331b9210e0b60661a4af073445edb01216994b0c2be60b203aea67957ab09398998cf3b47c894bfea61ced5bcae0628281c171eaf11438b481d3e728315976440a5b7c1303c73f945acd67271828bb99394e609b309f0cecd73affe86a9c925212042bb9fb457fc213c63f58ee8fc16eaf79ebf33203e3cb73b8a8f2724a525d97abe34cb02154131f81317fb44766caf39fbc84d22b010bb0389124f1c70873bb0a89ee1601aba9b46f2540c2414600947de265ceee6acbe277d29d05010d50d0934b2bd985145537211f6681eb5362ca604dd2226be4b457f4c96dc5bb9366a230546b0386389b18469574b6697607f5ed3c4c91463fa49087ce403671148e32186c7741ff107b73c3813392c424a4b71fe915bb470cab3f7bccf1961116755809b1ce4cb0a29d04422f0c0fe1a0b04dc178f573558b255f803c9d8495005a738f6c73cc1b56d1599604a514d7c347315fc7866706f0513ccf7d98fdbc70f931cbf9ebba18d976953099e45cb5ea58b4f51d182e1c99961ec2ffc338ffa8996edfabd122c0ea04a1e7be310e0934620812c8d708d50fca53f2c3250c80accea4f8f560ff916026b652d2c28404d4688d5d4638ec819571104de14aaf5234ffb574ec9339ae0f06d78647ac393b012f38db812c8fe128af8e742e7336a9ffc49720aabc1840064ba5d82c846f2390580b751be440f1edb6a03920be6e03324c6bc37032e57c9ca5354adb555843ef6ab8ec46971156574033617a3aca86b72db94a6ec6c4ce1c60d5eb02142396808936727256001e5312bea0fecdaafc71c0f0912972312a71301b6d04598a853933ee6210478510c0790602c50996c0386b6aa13a61f19b52904605aaef53751e1053bb2cbc46310fd2462b736ac2aaa6a50422a42c0b3d5d8a0fd5194b4672e3e396737694b0bfc4e2707a80d050161e975a6537595c59c3725c63e3a2dc93c555d6090c6acbd2dec8be97910ceb17a65d13bd259317b128851d4b630aa1ac6f43b67f89078b5bc925911063089218487fe382527c1bf8d976903d497d369986a1c716c74093ab57af39b2613fb27ae06bb47046a3e7b911f1badde3a75c615052f940a2b912aa8015db854be23e91d27870b2019375b7441fdc3c8c97068883aa07593707cc49950c6911a006f9b36a8a6fbbbf34c07cc549e1db92b1b7011e7f07ab17740972c7b71a6a0dc8cc35f5128d4f86e1da20f3b428f859b8aad97962db4c025c567b25c6283e2180557988f0a28964021ac329920bc7b5da4b08e5911db8485f1f707fcab5d71ec1d1fe973f079a55ba43d0495769490ad7804c3364b690463ad7245ca2ec54a575a43f6ba1c680561c39069b80665b7d42635104d864749f3d05ce9b3b29460278c56756fb9a67e62397a4a2905b383319a25885b5e64e9569904027fc5b78402493ba233aa1856a0427b1fb980e6608fadd79c7d4343f34926de385072b385d1ee78080bdaa9a58751e5328d707482d03dc3368ba3de755b94ed24e60bb387f418b02c79e7db1c919e3ad2cf39b2971a556124001d00208ba3de755b94ed24e60bb387f418b02c79e7db1c919e3ad2cf39b2971a556124001700410423de197b380e908685e0048054c85acf08a9749e10bfcaff91d3f30a736a79b7f5a7bc0cc2d94de9700820fff338d4c6224ade58fb7cd2817e2c62038327a8f5002b00050403040303000d0018001604030503060308040805080604010501060102030201002d00020101001c00024001001b000706000100020003fe0d01b90000010003b400200f5568a7748fc404fae5996e68e29a984ff345847cb0bb320b8edd448217cbf5018f728215741f57ec050f8c1ce81112a6fde9b1de12bc78a71f21282693ed44bc9550f81e6e310d9563d73354f8572a03377b06952713364a8eca199c11db8e27cf79a5e8046a80b30eb3e3a4287915103ee42b62e93d5ff55977191138548b6d4a309d53a375ef374e3851836a86bdc7934c42a479564bbcefad48ac48ad18de3b82b097966c1f5b9433c5177231c0acc1daf8326730261805f4ff394ba78b233f076ac3994743ffdec09bab56e9d9431e366de7b1858d22eeef5ab7421a6da721c8a2dc7b8b97229e9fd5ac8f5000822363f9378ac9b355692723c50a9a7e17749c3ea592df3b7dcd8dbc61b4b7d0412098f6c89558cbb03a57cf81525323082ba048bbb818d130b24a61dcb629e1a0f523587a9538bafad077670953b82fcec52a692866b96220d4aad44bde56e9086cb63efd7f45c0daba6409d24567d33048d6fbd9dbf5fdb4543b4d8b6cc4552a01c1d7c2e32962974a40e103abef6e8c518133e748792519b035b82a61aef2f57cc75b9fc4edc1489ad9ba1f12a61679896d5898d9b12753bf4d3a446c4cc1d700290094006f00694bc41df38cca8adb15be2ef5d0729e4a354f5e399a6f3a1e6e03d135db68b449cdf4963097cd00d23481be13f54217871ccba0f1ab05e093d903b549e1d3d57a90bc321427b5e27a37bd6d3e3b13c42b14c1c6a383a7756252b7d75b939546bbd1420b695e35a7478c8d36f00c00212044fd8e5f62610c8db647eeaa32b68e4741cc9aa93fa0b727702d07872946981d@@505249202a20485454502f322e300d0a0d0a534d0d0a0d0a00001804000000000000010001000000020000000000040002000000050000400000000408000000000000bf00010002df012500000003000000001582048163418aa0e41d139d09b8f3efbf877abed07f66a281b0dae053fad0321aa49d13fda992a49685340c8a6adca7e28102e16fed4b3bdc0b405c1fda988a4ea76040080010054c26b0b29fcb01680b835383f963e751b0f73ad7b4fd7b9fefb4005defaf73adbf97df6800bbbf5ee75b1e6fbed00176fe8b52dc377df6800bb3f45abefb4005c550929bd9abfa5242cb40d25fa523b3e94f684c9f73919d29ad1718628390744e7426e3cfbefb1f40811f8e98e8acd216c89254262ee3a2d2ff40818f8e98e8acd216c89254262ee3a2d2ff4081278e98e8acd216c89254262ee3a2d2ff4081938e98e8acd216c89254262ee3a2d2ff40812f8e98e8acd216c89254262ee3a2d2ff4081978e98e8acd216c89254262ee3a2d2ff40819b8e98e8acd216c89254262ee3a2d2ff40819f8e98e8acd216c89254262ee3a2d2ff4081378e98e8acd216c89254262ee3a2d2ff4081e98e98e8acd216c89254262ee3a2d2ff4081eb8e98e8acd216c89254262ee3a2d2ff4081a38e98e8acd216c89254262ee3a2d2ff4081a78e98e8acd216c89254262ee3a2d2ff4081ab8e98e8acd216c89254262ee3a2d2ff40813f8e98e8acd216c89254262ee3a2d2ff4081af8e98e8acd216c89254262ee3a2d2ff4081ed8e98e8acd216c89254262ee3a2d2ff4081b38e98e8acd216c89254262ee3a2d2ff4081478e98e8acd216c89254262ee3a2d2ff40814f8e98e8acd216c89254262ee3a2d2ff4081b78e98e8acd216c89254262ee3a2d2ff4081ef8e98e8acd216c89254262ee3a2d2ff4081f18e98e8acd216c89254262ee3a2d2ff4081f38e98e8acd216c89254262ee3a2d2ff4081f58e98e8acd216c89254262ee3a2d2ff4081f78e98e8acd216c89254262ee3a2d2ff1f1187ea5f50771d1697408a4148b4a549275a42a13f842d35a7d7408a4148b4a549275a93c85f8321ec47408a4148b4a549275906497f8840e92ac7b0d31aaf4086aec31ec327d783b606bf4082497f864d833505b11f")
var Firefox_Mac_arm64_144 = ParseGospiderSpecNoError("16030108950100089103031f80f0e1128ad46eebc2f11574275cb7ea8ab7376be2a827a2144d34347e6be62079f9e9cadc663aa89355465bcff65209f37d346bd6b86087293d8abef270dbc10022130113031302c02bc02fcca9cca8c02cc030c00ac009c013c014009c009d002f0035010008260000000e000c0000096c6f63616c686f737400170000ff01000100000a0010000e11ec001d00170018001901000101000b000201000010000e000c02683208687474702f312e310005000501000000000022000a00080403050306030203001200000033052f052d11ec04c0fc965374f310149768ae1abd52d5b870d0a8d8063f4339bd479a2dc23188747ca416bc8e4c519e1e3b7250c48780e36ccee971b308368b04a7a3401faafc7eb8ea7f41d024e7ac5c2b45c444f42c0f5b440bba957e930630444513b81698f162915324144c220618467ed80d45fa4743ac7f243b88419caf0026a1dc1001884375d7707d90e7b30e57733b6aaa7041b6ca2c02ab639601456a9d6b327fd965f04ac10d095be8e47d8684b919c73ed683bd25fb35df71c52c18c98d20ad5f9902b3345237574bdd03412ae27f1ff52dc90a5533f1216ab2694254704dd88a4404806d506c13438db18a50fb1004f4a316deb4c794c51893727d19d8823da48e02403a7934b7ea5977aef8b9ab132f709286e47816bb26425ed846bcd33889026470a1cb68419eb433a26469254e6b239080a7f1d71c50d0b3242651d2f05f8a37c45b5ab70297501746023dd2945d98c18a2aa02a239de260a043404dbdf4839db21674103634817e9de32aaf589c69ea97ad0c5be2b20f247a64e1eb0f76c05b9eba912ceb9ac6485345147a19e6266b2b0c00a88b22bc9a18f94133654d22f37dcb691d0ef283e069801b24709ecb8641b4b414c09cf013b641387148a89ea52855ede4ac9438c7e3508efe12c9c2db60b1caa83532c75feac1bbf12a29bc707c2653b6702dc1e328ae50817250c23ca585efc3220f393de01b193f0c832d5c38049a4ec2d9922381cd306a54a9967f18d7b7543225d8027cb2e0ce5d31cd5f7ab2b54942701bc30041a2ed7c9edd0b45a6cc444dea3445a50167309d2118cf8851a910097de1986f63e0cc07e7363375472405853e7bae940841d639576c94408c9486a02463524064614b76c81401ef0224a22186a9858b10386bf11335f0c780027188b1b592b2e38fcd82721789909cd2bc576a1e22a538a7d203cc56784e68a07d75021d22372e457f0b29a10bd7b416fc0fc8117139b0be615167f254c89215361a2546ae68c4ab4932b4f684da400374297dc828442eb423c74a6cf2b4c0bde6b470f198fc615340f47562391392578912fa1985763ddca3717aca26827a1a6738687bcc5860b357e3d1b6b471973868ca6ab3a5e38928f54a9b28cabe51ccac43c311704385a7c548b4e0b9ac21cd2c70c92bb0053e4c6c65a286e4517faf8c09eea05191db6787993fa9fba67501c59195a00b9b2f2e192d3a64aff902a90825abecd1894b5b2fc0070c6475aac44b1e0fb3bc365529c0d7b5bc242881f6934e27112583c6ba72cb5314c18f4547e612bac0f74e2439b642c269ded13ba2b0687238cc1acc6301fcc9c5970404e4c9d65939a2152f55e52dfed10451da0f3e8b18411c98cbcb2223570187440d2b4b5e52662443d285bfd44c0711c7fc20709469968715c99d357c76d54991aa39137c112cab2cd4d4cdd666c14447672dbc029e666170e303b1d96d6e412fe32959b215a88bf9b000182bb9f0556a49b9863023e0f8884d0113f08c00809597239a994ca12f9acab728db1f654b2c0188b22b870924117008e1557d810edea9ce9b4879c3709315d99473e08febab77a1977513034b040935270a4ebea17cb9f9b1fb006365f239437c80f7f10915109ba98b98dc15fce13e6e178b9e37597ad1c3c5c6633ea3c5335cc381982607d2e83a8cbf8f3a94d53766be295ecc3d3be1e098880795453e9cd7e5fb5d7b001d002007d2e83a8cbf8f3a94d53766be295ecc3d3be1e098880795453e9cd7e5fb5d7b0017004104bbf2376ebd52ecaee45a0199c3d5d9cf2a04528d4b5a6b3eeb0c4336f020e94ef3559174db32791bb661a80e63c569209e763a1cd8302ab614b57adc88053673002b00050403040303000d0018001604030503060308040805080604010501060102030201002d00020101001c00024001001b000706000100020003fe0d01b90000010001b40020c4f20eae218deadd081ff5a5b17161bc51cf0948703eaf4ba1b6f85ae201f229018f219e3d4572c8908e4ae4d0776983f4a9c8539f2ce70b78edac0cafc6dd3d222e646f6ecde610174810da41dad0b02e2bc163d16681b19a0ce768855eac1e2814543dddd03e227fd96177df33ce560417e2ac8925f71a96809036bc563d7679ee6fc8a25892705f267f0777fb29f33f6d79c09bc23910e7c4612cea347b1acc83dd4c615777fca2669ecabf02b28728cb06e6c25ce123b3d89fd7b5133a24322e225b6288f05d2c176ebad606ab904e74082391e1ef83d917f2f901da3649e54b46adefcbaa3a3a4f1dbf3e3a5c1504c95335417e6a01a141c9139ee8e4aa2a6a10179b4c0bb3f1ff05b6407c1d5bf7da219ede33ae03a7739c9e3391c3c9b24b01b91b39ecbca856188ffee03694f92aa80ffb1615a1a59d873a24dd57190dc99c75d9567e9f1c0d03eac372965fc9c43f777a3469b6c22e41e2ee7db3082a72aa82e85eba60b1ad16ef5dc38d7d945fef345cf2a6ffdfee00baec1a81775dacf1ee59613a748307bd5083b0155d28de3018a2de81aabac85303815bf8ee811fe67a16f694985a65f3e262235d009a00290094006f006944a07abc46e701e454c3cc38465c47e49f60b512e46606351cfbd3a0ec957b369f3e0584ea757558558a04ffcfb15aab0bf87b35d16033ff7202826d2d946748c4f87d1870050a14b1ac98815eb2d60c4785d0e1a3970eeb34e07e135bbabb7656d3630b6b818e99757a1983b4002120d51da08686a2b78ab6482d63d634a51b2f9959221c12547a0e78f33f53c3ab87@@505249202a20485454502f322e300d0a0d0a534d0d0a0d0a00001804000000000000010001000000020000000000040002000000050000400000000408000000000000bf0001000142012500000003000000002982048163418aa0e41d139d09b8f3efbf877abed07f66a281b0dae053fad0321aa49d13fda992a49685340c8a6adca7e28102e16fed4b3bdc0b4d2e0fed4c452753b02004000802a61358594fe580b4d2e053b0497ca589d34d1f43aeba0c41a4c7a98f33a69a3fdf9a68fa1d75d0620d263d4c79a68fbed00177febe58f9fbed00177b51b0f73ad7b4fd7b9fefb4005defaf73adbf97df6800bbbf5ee75b1e6fbed00176fe8b52dc377df6800bb3f45abefb4005c550929bd9abfa5242cb40d25fa523b3e94f684c9f4092b6b9ac1c8558d520a4b6c2ad617b5a54251f810f408a4148b4a549275a42a13f8690e4b692d49f408a4148b4a549275a93c85f86a87dcd30d25f408a4148b4a549275906497f83a8f517408a4148b4a549275ad416cf82ff034086aec31ec327d785b6007d286f4082497f864d833505b11f")

// safari
var Safari_Mac_arm64_18 = ParseGospiderSpecNoError("1603010200010001fc030328164c50c4f3c5e1370b5a5d93de8ec923dc9bf12294edd9cba2409413cfdda3201b47193e1616368cd43ad0391c3064a34b8a01b84d44312e132ec46cc77f8e9f002a2a2a130113021303c02cc02bcca9c030c02fcca8c00ac009c014c013009d009c0035002fc008c012000a010001893a3a00000000000e000c0000096c6f63616c686f737400170000ff01000100000a000c000a5a5a001d001700180019000b000201000010000e000c02683208687474702f312e31000500050100000000000d001600140403080404010503080508050501080606010201001200000033002b00295a5a000100001d002060cdc373e7d1278668cf1de66a08372bee38edd15b15b526c4a4d551dde0e632002d00020101002b000b0a9a9a0304030303020301001b00030200012a2a000100001500c700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000@@505249202a20485454502f322e300d0a0d0a534d0d0a0d0a000018040000000000000200000000000300000064000400200000000900000001000004080000000000009f00010002da0105000000018287418aa0e41d139d09b8f3efbf844001628e98e8acd216c89254262ee3a2d2ff40017a8e98e8acd216c89254262ee3a2d2ff4001638e98e8acd216c89254262ee3a2d2ff4001648e98e8acd216c89254262ee3a2d2ff53032a2f2a4001658e98e8acd216c89254262ee3a2d2ff4001668e98e8acd216c89254262ee3a2d2ff4001678e98e8acd216c89254262ee3a2d2ff7ad8d07f66a281b0dae053fad0321aa49d13fda992a49685340c8a6adca7e28104416e277fb521aeba0bc8b1e63258700dae15c2da9fd66c7bf467fa5283752a988a4ea7fed4e25b1063d4c05e5db5370e51d8661c036b8570b74001688e98e8acd216c89254262ee3a2d2ff408a4148b4a549275906497f8840e92ac7b0d31aaf4001698e98e8acd216c89254262ee3a2d2ff40016a8e98e8acd216c89254262ee3a2d2ff40016b8e98e8acd216c89254262ee3a2d2ff40016c8e98e8acd216c89254262ee3a2d2ff73919d29ad1718628390744e7426e3cfbefb1f40016d8e98e8acd216c89254262ee3a2d2ff40016e8e98e8acd216c89254262ee3a2d2ff40016f8e98e8acd216c89254262ee3a2d2ff4001708e98e8acd216c89254262ee3a2d2ff408a4148b4a549275a93c85f8321ec475886a8eb10649cbf4001718e98e8acd216c89254262ee3a2d2ff4001728e98e8acd216c89254262ee3a2d2ff4085aec1cd48ff86a8eb10649cbf4001738e98e8acd216c89254262ee3a2d2ff4001748e98e8acd216c89254262ee3a2d2ff4001758e98e8acd216c89254262ee3a2d2ff4001768e98e8acd216c89254262ee3a2d2ff408a4148b4a549275a42a13f842d35a7d74001778e98e8acd216c89254262ee3a2d2ff4001788e98e8acd216c89254262ee3a2d2ff4001618e98e8acd216c89254262ee3a2d2ff4001798e98e8acd216c89254262ee3a2d2ff5190f73ad7b4fd7b9d6c63a91f7da002efff4086aec31ec327d785b6067e9437508d9bd9abfa5242cb40d25fa523b31f1187ea5f50771d1697")
var Safari_Mac_arm64_26 = ParseGospiderSpecNoError("16030105f7010005f303036b1dc6b1ddee106c21cf8498c90839444f3e1706af3a806f591ff8de0314236a202177f091b60645c76e0def37d5e37692a28f620ef07e70ca0c3b05f295affad9002a6a6a130213031301c02cc02bcca9c030c02fcca8c00ac009c014c013009d009c0035002fc008c012000a010005801a1a00000000000e000c0000096c6f63616c686f737400170000ff01000100000a000e000c6a6a11ec001d001700180019000b000201000010000e000c02683208687474702f312e31000500050100000000000d00160014040308040401050308050805050108060601020100120000003304ef04ed6a6a00010011ec04c08f00c84420bd5f31057f4c9ba5864e61514ba8d670e8509bd5cc9ccba70f048448f424865af26cb795a10790c973d981e0b572008315e8033190b12887e334da583a11d956cec32810138d6a336580e0990822a197396f5bbbb95960069f176e01902bb4938395c42a5637a521699e34fa273eea2fc849b37200772fe5175ae722d2312c49a18e36317db26ab6aeb0bd7bf1b5f0042bd5004f26078c0cd69ff6c94bdc880bde5c6286c65c4b0b8cecc791cc88ac58da4965e9474bf1189df546202c9a4177a1aaa8b582da4c78821721551149b222444ab3f3d183c5969f3aa0a03481a5ca07ba495c1791a46c4296047cb20887e66b184c33cc43bf98713d60ecc79e24b87d24ab9de39620f65301652eefb44da402b8e1505b4d9a94b26327b157b073e161dcdb25bdfa081332c0277a19510793a7889225bccc8a8ac29dd6c45ea6c4222c0ef210981d8ac0c4766b51f7ce4490c1e2c6b22a8a1a70c2b031360ab5a32b71d2092d973976e06970a1b332f29ae2c60ea9a1181f3c05eaf97274b0254c589a97430231f072f97114e6c29bebda3a1672b9455c90ed65a53cf706132cbc98d24b5c61a708d54fda1541a40b280329ccaf16c9546013df077011282962aa482d023d114c49b6a06cc39b192862b1d7d86953320a36fb45d5232c92c41d3b451d1cbc0d9d7283ecd46579ec3d7b798197d1a00d41951c80c3d7db587355008dc684ab749d2ca9439be3137335a8ef13215c21952780923a5144340556ea21450d512fe1e97da79badd513a7d62c692b2467087411786b464e65751c7c0b8a624b68fc3791986fc84065b81b45ce16b0aa7c66f29910771b8b35641c060197fa91124162c82bb97e3e291b7ce0b1291051b97313514c5724aa98c0602643cb0ec2745947932100501f721bc6d77527151aac16dcad819bc388e007f50876a5369f585b7ec744b75eb0a21a9b91611442be32a34f2308016020eb61aec3d58db180895ebba0b2f223a22391a3751b08a43b6be20ab2cb55e9a1bbcae9c05f540a17fc824d0b7f55542315861345b3c5c072a8390b36cf800da6ca888a407a98e93db3dacfc8791270cc4d3b69841f3b7e3f8395ee4ba5164461c0ec44d836075d6cc8908aad0ef27f1f1987e6887fb6388fbaf1a7106a8cfc963363a01a4ab4490bc877e8a894c416667ef090ae48c9add2278f950d8596245fb104b4010b1e3417d27c9f9ba65975c6c97a1754e1678b2a9c73b36bb1f8c61960da33f7e7b3a8b3785463c725b7bf3f650bc69943a7ea7d376a9a74717b03756d729240dfaaccbbf3ad0df11d45492bbb7982335c806f19bcce11483376162da9b143e016f6b219829b34295620bc412ea2396dc70cb027ac9a071c2019c96d896524f801521585baf933c49fa469eb4542d1711d87413a76e601e72cb314b286df80b77eb747dfbc4686ac6eb3ba92806b95020459633c55399009e3044cd765912fb3cbe59535a2b774b8e3753dc5afee52c9fa476ef746b06ba64fc087cc52e1210f17a10b450366135f0952ba6d786d2f72459424a8e9e93bbb360cfd31a33cc04122b3370f86355c3b600078cdf951637c5135ae70baf760b3a58b664350b46f0f4a4c1f2882d505fe6a774da9ad0f55c497a4e0460e0285f3ec15570e11c1cd8218037bb16bc50cc272f8c58235afe6f6a6f6e6623d7a82a51a036ee47979001d0020dd109ac3c2666d03192e46921398cdf799dc1148807497f8e71c85fd43de9956002d00020101002b000706baba03040303001b00030200015a5a000100@@505249202a20485454502f322e300d0a0d0a534d0d0a0d0a000018040000000000000200000000000300000064000400200000000900000001000004080000000000009f00010002c60105000000018287418aa0e41d139d09b8f3efbf844001628e98e8acd216c89254262ee3a2d2ff40017a8e98e8acd216c89254262ee3a2d2ff4001638e98e8acd216c89254262ee3a2d2ff4001648e98e8acd216c89254262ee3a2d2ff53032a2f2a4001658e98e8acd216c89254262ee3a2d2ff4001668e98e8acd216c89254262ee3a2d2ff4001678e98e8acd216c89254262ee3a2d2ff7ac4d07f66a281b0dae053fad0321aa49d13fda992a49685340c8a6adca7e28104416e277fb521aeba0bc8b1e63258700dae15c2da9fd66c7bf467fa5283752a988a4ea7feff4001688e98e8acd216c89254262ee3a2d2ff408a4148b4a549275906497f872587421641925f4001698e98e8acd216c89254262ee3a2d2ff40016a8e98e8acd216c89254262ee3a2d2ff40016b8e98e8acd216c89254262ee3a2d2ff40016c8e98e8acd216c89254262ee3a2d2ff40016d8e98e8acd216c89254262ee3a2d2ff40016e8e98e8acd216c89254262ee3a2d2ff40016f8e98e8acd216c89254262ee3a2d2ff40853d8698d57f9640e51d865ac28e42d9718628390744e7426e3cfbefff4001708e98e8acd216c89254262ee3a2d2ff408a4148b4a549275a93c85f8321ec475886a8eb10649cbf4001718e98e8acd216c89254262ee3a2d2ff4001728e98e8acd216c89254262ee3a2d2ff4085aec1cd48ff86a8eb10649cbf4001738e98e8acd216c89254262ee3a2d2ff4001748e98e8acd216c89254262ee3a2d2ff4001758e98e8acd216c89254262ee3a2d2ff4001768e98e8acd216c89254262ee3a2d2ff408a4148b4a549275a42a13f842d35a7d74001778e98e8acd216c89254262ee3a2d2ff4001788e98e8acd216c89254262ee3a2d2ff4001618e98e8acd216c89254262ee3a2d2ff4001798e98e8acd216c89254262ee3a2d2ff5190f73ad7b4fd7b9d6c63a91f7da002efff4086aec31ec327d785b6067e9437508d9bd9abfa5242cb40d25fa523b3")

// edge
var Edge_Mac_arm64_141 = ParseGospiderSpecNoError("16030106d2010006ce030323d2bc46eb2db242bd9fb2de70eaf8987b146a03af14f1cfabe4706dffee5acf205e1580af72de8685baf0ea70e693143b8824f106fe2ca7c06a40e0881d992c4a0020baba130113021303c02bc02fc02cc030cca9cca8c013c014009c009d002f0035010006659a9a00000010000e000c02683208687474702f312e310000000e000c0000096c6f63616c686f7374002b0007063a3a03040303000d0012001004030804040105030805050108060601001b0003020002fe0d00da0000010001e000208e6d7df5992f6eda7ab5502824b5bbb928024289556bfce6f4f16a085d93cb4900b02310152902dc0dc940d1610404ab4624fb95d2299f0b6d6a0ebd4a8d29c227089608007c9789ceb5d63fbcae3279b87a8864cbc491d1c61a9b541528dc0d48a5d963bdae25272260a142d136fbe37efeda50f0818ee6be684484fc7f3365807df19e3bb149062afa6b0651e63af2e180e6c5b5da0d51a9e1ea4df199bca0aa27c7f974a5c6e64767dce15ceae25bfbcc5024aae1530874789506de60f2f8acf2cb8b3894638eb6e83963a7a70cdd0a43003304ef04ed5a5a00010011ec04c0c489a803621e701330f4540a76a9692ad2affb15b2d4817be3b4507309cc810123ab13a7e30bc6d4602f08c47e5d3a31892850dd7325137c253ceb4bb208566dea7fd9726b8816865afabc0503145622c34ffa936bd25f2149073a1b66278262c8967a57fbbcce81a6d288c79350664f193d02cb09766655d3e3085ab0905b05376beca049660ee8c8508da23233e756c32589837734e0ac39a50196f475b51a3603fc503460890c7adc26f5657eff025f84dc19b1817549989596b7a64d6646ab665a842abe983340ea2a302132b14b34c34b041203264faaa33a1fa9adf03889426c4bc1d3697153a48db267d956188c5326ed409a642c5d6ec423bf6c12af269010bb241f22805bd57feb534814d56fbd35518009bd4ae8171de79501a0693ea28d91609f067386654bbbba8743e0077e5e471739108d772a2b2b491e603a81c2aa3471e9b81a2c660dbbcaec80cbda4471dedc6b17fc999898bcbddb6c75004b446c0ed53c5a6690abfac49978507a9e557383b574759b9f5dac022795be4ad862fc58514b35c7bf0c77270c2e744ac35df097114c6600bcb69552a4b10565c492c8a3d672d0c784132b3bc934786fa890f6c3b503eb0b732ac02002a59af1a1eba3b04160707361cc26b5492fc9ab21fc999fe81b0a16398c76aae3d7a7dbb8cbeb011e4fc1968ff2064da13e28031a33c6c72a09b5cb827c53c854e3110254c314e17b08a534117b523d4e8a5fe6d865f0579d2362792a9437b01a67091a664ac7125ee48308859053963a3931a7d49c4cc68a669905705f953efc7b52a13383188883d5835bd9b7a0ba19c3c8d800a424150b87413b21291ec4bf3786a449171574412e064ab7f74880b31ab2d89a424ce07b80eb8a65b236ec646b44f0109df608d9794a459916e1c45cabe96756ab6c4e1a9e217c89fbd9b28c9718dd87aa8711c305a142b14029c0ebbfa7fa8600e1b7d7e082fda5543bb027bfe679750c376c214b1bf27da23a90951bcc4f99a40908818ff8af27eb0980da83cc9022cb9a847536b072a4787756436bc51f62e064416623d494927cc1b9aee063261a8df5b5a18c63312cfa0ec8d57940f4a9a956aeaa156356f2275444597bb3355b37bfe0d6b94b51a5a41b937d4396218b245b57bafc50c854aa17347a2070868ac7f3cb7045afa3bb3ae518ac53b51db7486869438b4ca8050c028db92840dfb15c15cb8f31a0908223030b193a3a261ae8da5af32c87e690890bf5757f85c318596f8bac762ab395884075d65ca9bf0c956bc95cc91ab362265194cc27f593ac310a3d440b67c135c0dcac9183226303898d0e1c9a50e1a34293b91ea667f54ab3eba7c69c8341aba3cd85903b8e598d6e3b90f356cbf46115896b13a2ea485cba9a0f3621d0db631a3c598045513cb7a716a3babb032e85bba07593141b72a0d8dcc6327402bce533a9e1c9cc4b10f95870b8c75f0b134c1c675866d776fcf61790fb3af4f56963e5a7773521acc21a99c1233db33bc4345f1c471659817e56540e2653736d468bb228b8ed9b0093db72d59451388a7469b51dfc5323eba33bc0a535c526c54166892da35e625a41795753de46026828114cd6425af72cf448e219c6c410812cf3c3ef26e86ebb6c77f294e0702fd14ec1230c730292dda3c6b671526c3b821b6a4c6300fcfc4101f99ca78be11877d89031ddb395d96d001d0020c4fdd6ee4b1004606376c949530a0f55bd341855d6d345696909d5849faeff45ff010001000023000044cd00050003026832000500050100000000000a000c000a5a5a11ec001d00170018000b000201000017000000120000002d000201018a8a000100@@505249202a20485454502f322e300d0a0d0a534d0d0a0d0a00001804000000000000010001000000020000000000040060000000060004000000000408000000000000ef00010000000401000000000001b401250000000180000000db82418aa0e41d139d09b8f3efbf8704896251f7310f52e621ff408d4148b1275ad1ad5d034ca7b29f07226d61634f53227ae3d07f66a281b0dae053fad0321aa49d13fda992a49685340c8a6adca7e28104416e277fb521aeba0bc8b1e632586d975765c53facd8f7e8cff4a506ea5531149d4ffda97a7b0f49580b415c0b817029b8728ec330db2eaecb8a60926602d05702e05c1f40874148b1275ad1ffb8fe7418961d07952a609262ff3f7de0fe42d07f9fa53f9d274ff90c576c1d527f3f7de0fe5efe7e94fe6f4f61e935b4ff3f7de0fe42d07f9f408b4148b1275ad1ad49e33505023f3053b1352398ac0fb9a5fa352398ac782c75fd1a91cc56075d537d1a91cc5611de6ff7e69a3e8d48e62b1f3f5f2c7cfdf6800bbd408a4148b4a549275906497f8840e92ac7b0d31aaf408a4148b4a549275a93c85f85a8eb10f623408a4148b4a549275a42a13f84352398bf73919d29ad1718628390744e7426e3cfbefb1f50929bd9abfa5242cb40d25fa523b3e94f684c9f51a6f73ad7b4fd7b9fefb4005dffa2d5f7da002ef7d16a5b15dfbed001777e8b52dc377df6800bb94086aec31ec327d785b600fd286f")

func AutoAddHeaders(req *http.Request) {
	userAgent := req.Header.Get("User-Agent")
	ua := useragent.Parse(userAgent)
	if !ua.IsChrome() && !ua.IsSafari() && !ua.IsFirefox() {
		return
	}
	var sec_ua string
	var sec_mobile string
	var sec_platform string
	if ua.IsChrome() {
		if ua.VersionNo.Major >= 76 {
			sec_ua = fmt.Sprintf(`"Chromium";v="%d", "Google Chrome";v="%d", "Not_A Brand";v="99"`, ua.VersionNo.Major, ua.VersionNo.Major)
		}
	} else if ua.IsEdge() {
		if ua.VersionNo.Major >= 79 {
			sec_ua = fmt.Sprintf(`"Chromium";v="%d", "Microsoft Edge";v="%d", "Not_A Brand";v="99"`, ua.VersionNo.Major, ua.VersionNo.Major)
		}
	}
	if sec_ua != "" {
		if ua.Mobile {
			sec_mobile = "?1"
		} else {
			sec_mobile = "?0"
		}
		if ua.IsMacOS() {
			sec_platform = `"macOS"`
		} else if ua.IsWindows() {
			sec_platform = `"Windows"`
		} else if ua.IsLinux() {
			sec_platform = `"Linux"`
		} else if ua.IsAndroid() {
			sec_platform = `"Android"`
		} else if ua.IsIOS() {
			sec_platform = `"iOS"`
		} else if ua.IsChromeOS() {
			sec_platform = `"Chrome OS"`
		}
	}
	if req.Header.Get("Sec-Ch-Ua") == "" {
		req.Header.Set("Sec-Ch-Ua", sec_ua)
	}
	if req.Header.Get("Sec-Ch-Ua-Platform") == "" {
		req.Header.Set("Sec-Ch-Ua-Platform", sec_platform)
	}
	if req.Header.Get("Sec-Ch-Ua-Mobile") == "" {
		req.Header.Set("Sec-Ch-Ua-Mobile", sec_mobile)
	}
	if req.Header.Get("sec-fetch-site") == "" {
		req.Header.Set("sec-fetch-site", inferSecFetchSite(req))
	}
	if req.Header.Get("sec-fetch-dest") == "" {
		req.Header.Set("sec-fetch-dest", inferFetchDest(req))
	}
	if req.Header.Get("sec-fetch-mode") == "" {
		req.Header.Set("sec-fetch-mode", inferFetchMode(req))
	}
	if req.Header.Get("accept-language") == "" {
		req.Header.Set("accept-language", "en-US,en;q=0.9")
	}
	if req.Header.Get("accept-encoding") == "" {
		req.Header.Set("accept-encoding", "gzip, deflate, br, zstd")
	}
	if req.Header.Get("accept") == "" {
		req.Header.Set("accept", "text/html,application/xhtml+xml,application/xml;q=0.9,application/json,text/plain;q=0.8,image/avif,image/webp,image/apng,image/svg+xml,image/*;q=0.8,video/mp4,video/webm,video/ogg,audio/mpeg,audio/ogg,audio/wav,font/woff2,font/woff,font/ttf,font/otf,application/font-woff,application/font-woff2,application/octet-stream,*/*;q=0.5")
	}
}

type utlsId struct {
	version int
	id      utls.ClientHelloID
	spec    *GospiderSpec
}
type browserType string

const (
	Firefox browserType = "Firefox"
	Chrome  browserType = "Chrome"
	Ios     browserType = "Ios"
	Okhttp  browserType = "Okhttp"
	Safari  browserType = "Safari"
	Edge    browserType = "Edge"
)

var utlsIds = map[browserType][]utlsId{
	Firefox: {
		{
			version: 55,
			id:      utls.HelloFirefox_55,
		},
		{
			version: 56,
			id:      utls.HelloFirefox_56,
		},
		{
			version: 63,
			id:      utls.HelloFirefox_63,
		},
		{
			version: 65,
			id:      utls.HelloFirefox_65,
		},
		{
			version: 99,
			id:      utls.HelloFirefox_99,
		},
		{
			version: 102,
			id:      utls.HelloFirefox_102,
		},
		{
			version: 105,
			id:      utls.HelloFirefox_105,
		},
		{
			version: 120,
			id:      utls.HelloFirefox_120,
		},
		{
			version: 140,
			spec:    Firefox_Mac_arm64_140,
		},
		{
			version: 144,
			spec:    Firefox_Mac_arm64_144,
		},
	},
	Chrome: {
		{
			version: 58,
			id:      utls.HelloChrome_58,
		},
		{
			version: 62,
			id:      utls.HelloChrome_62,
		},
		{
			version: 70,
			id:      utls.HelloChrome_70,
		},
		{
			version: 72,
			id:      utls.HelloChrome_72,
		},
		{
			version: 83,
			id:      utls.HelloChrome_83,
		},
		{
			version: 87,
			id:      utls.HelloChrome_87,
		},
		{
			version: 96,
			id:      utls.HelloChrome_96,
		},
		{
			version: 100,
			id:      utls.HelloChrome_100,
		},
		{
			version: 102,
			id:      utls.HelloChrome_102,
		},
		{
			version: 106,
			id:      utls.HelloChrome_106_Shuffle,
		},
		{
			version: 112,
			id:      utls.HelloChrome_112_PSK_Shuf,
		},
		{
			version: 114,
			id:      utls.HelloChrome_114_Padding_PSK_Shuf,
		},
		{
			version: 115,
			id:      utls.HelloChrome_115_PQ,
		},
		{
			version: 120,
			id:      utls.HelloChrome_120,
		},
		{
			version: 131,
			id:      utls.HelloChrome_131,
		},
		{
			version: 133,
			id:      utls.HelloChrome_133,
		},
		{
			version: 137,
			id:      utls.HelloCustom,
		},
		{
			version: 141,
			spec:    Chrome_Mac_arm64_141,
		},
		{
			version: 142,
			spec:    Chrome_Mac_arm64_142,
		},
	},
	Ios: {
		{
			version: 11,
			id:      utls.HelloIOS_11_1,
		},
		{
			version: 12,
			id:      utls.HelloIOS_12_1,
		},
		{
			version: 13,
			id:      utls.HelloIOS_13,
		},
		{
			version: 14,
			id:      utls.HelloIOS_14,
		},
	},
	Okhttp: {
		{
			version: 11,
			id:      utls.HelloAndroid_11_OkHttp,
		},
	},
	Safari: {
		{
			version: 16,
			id:      utls.HelloSafari_16_0,
		},
		{
			version: 18,
			spec:    Safari_Mac_arm64_18,
		},
		{
			version: 26,
			spec:    Safari_Mac_arm64_26,
		},
	},
	Edge: {
		{
			version: 85,
			id:      utls.HelloEdge_85,
		},
		{
			version: 106,
			id:      utls.HelloEdge_106,
		},
		{
			version: 141,
			spec:    Edge_Mac_arm64_141,
		},
	},
}

func AutoSelectSpec(userAgent string) *GospiderSpec {
	ua := useragent.Parse(userAgent)
	if ua.IsFirefox() {
		return selectSpec(Firefox, ua.VersionNo.Major)
	}
	if ua.IsChrome() {
		return selectSpec(Chrome, ua.VersionNo.Major)
	}
	if ua.IsIOS() {
		return selectSpec(Ios, ua.VersionNo.Major)
	}
	if ua.IsAndroid() {
		return selectSpec(Okhttp, ua.VersionNo.Major)
	}
	if ua.IsSafari() {
		return selectSpec(Safari, ua.VersionNo.Major)
	}
	if ua.IsEdge() {
		return selectSpec(Edge, ua.VersionNo.Major)
	}
	return nil
}
func selectSpec(btype browserType, version int) *GospiderSpec {
	// spec, version := selectSpecAndVersion(utlsIds[btype], version)
	// log.Print(btype, "  ==    ", version)
	spec, _ := selectSpecAndVersion(utlsIds[btype], version)
	return spec
}
func selectSpecAndVersion(uids []utlsId, version int) (*GospiderSpec, int) {
	var lastSpec *GospiderSpec
	for i := len(uids) - 1; i >= 0; i-- {
		if version >= uids[i].version {
			if uids[i].spec != nil {
				return uids[i].spec, uids[i].version
			}
			var spec *GospiderSpec
			if lastSpec != nil {
				spec = lastSpec.Clone()
			} else {
				spec = utlsIds[Chrome][len(utlsIds[Chrome])-1].spec.Clone()
			}
			spec.TLSSpec.setClientHelloID(uids[i].id)
			return spec, uids[i].version
		} else if uids[i].spec != nil {
			lastSpec = uids[i].spec
		}
	}
	return nil, 0
}
